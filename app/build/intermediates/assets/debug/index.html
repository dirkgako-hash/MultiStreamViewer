<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="theme-color" content="#1e3c72">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Multi Stream Player</title>
    <link rel="manifest" href="data:application/manifest+json,{}">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background:#0a0a0a; 
            color:#fff; 
            padding:0;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Players Container */
        .players-container { 
            flex: 1;
            display:grid; 
            gap:2px; 
            padding:2px;
            min-height: 0;
            width: 100%;
            height: 100%;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }
        
        .layout-2x2 { grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(2, 1fr); }
        .layout-1x4 { grid-template-columns: repeat(4, 1fr); grid-template-rows: 1fr; }
        .layout-4x1 { grid-template-columns: 1fr; grid-template-rows: repeat(4, 1fr); }
        .layout-1x2 { grid-template-columns: repeat(2, 1fr); grid-template-rows: 1fr; }
        .layout-2x1 { grid-template-columns: 1fr; grid-template-rows: repeat(2, 1fr); }
        .layout-1x3 { grid-template-columns: repeat(3, 1fr); grid-template-rows: 1fr; }
        .layout-3x1 { grid-template-columns: 1fr; grid-template-rows: repeat(3, 1fr); }
        .layout-1x1 { grid-template-columns: 1fr; grid-template-rows: 1fr; }
        
        /* Player Slot */
        .player-slot { 
            background:#1a1a1a; 
            border-radius:2px; 
            overflow:hidden; 
            border:1px solid #333; 
            position:relative;
            display: flex;
            flex-direction: column;
            min-height: 0;
            min-width: 0;
        }
        
        .player-slot.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 10000;
            border-radius: 0;
            border: none;
            background: #000;
        }
        
        /* Controls Overlay */
        .player-controls-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.8);
            padding: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-size: 12px;
        }
        
        .player-slot:hover .player-controls-overlay {
            opacity: 1;
        }
        
        .player-title { 
            font-weight:bold; 
            font-size:12px; 
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .player-buttons { 
            display:flex; 
            gap:4px; 
            align-items: center; 
            flex-wrap: nowrap;
        }
        
        .player-buttons button { 
            background:#444; 
            border:none; 
            color:white; 
            padding:6px 10px; 
            border-radius:4px; 
            cursor:pointer; 
            font-size:11px; 
            white-space: nowrap;
            min-width: 40px;
        }
        
        .player-buttons button:hover { 
            background:#555; 
        }
        
        .speed-control {
            position: relative;
            display: inline-block;
        }
        
        .speed-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: #333;
            border-radius: 4px;
            padding: 5px;
            z-index: 100;
            min-width: 80px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        
        .speed-dropdown.show {
            display: block;
        }
        
        .speed-option {
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 12px;
            text-align: center;
        }
        
        .speed-option:hover {
            background: #444;
        }
        
        .speed-option.active {
            background: #1e3c72;
            color: white;
        }
        
        /* Video Container */
        .video-container {
            flex: 1;
            position: relative;
            min-height: 0;
            background: #000;
            width: 100%;
            height: 100%;
        }
        
        .video-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: #000;
        }
        
        /* Main Controls */
        .main-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            align-items: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.7);
        }
        
        .main-controls select,
        .main-controls button {
            padding: 8px 12px;
            background: #333;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            min-width: 60px;
        }
        
        .main-controls button {
            background: #1e3c72;
            font-weight: bold;
        }
        
        .main-controls button:hover {
            background: #2a4a8c;
        }
        
        /* URL Input */
        .url-input-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            align-items: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.7);
            min-width: 300px;
        }
        
        .url-input-container input {
            flex: 1;
            padding: 8px 12px;
            background: #222;
            color: white;
            border: 1px solid #444;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .url-input-container button {
            padding: 8px 16px;
            background: #1e3c72;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        /* Status Message */
        .status-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            display: none;
            max-width: 300px;
            word-wrap: break-word;
        }
        
        .status-message.show {
            display: block;
        }
        
        /* Fullscreen controls */
        .fullscreen-exit-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 15px;
            cursor: pointer;
            z-index: 10001;
            font-size: 14px;
            display: none;
        }
        
        .player-slot.fullscreen .fullscreen-exit-btn {
            display: block;
        }
        
        /* Loading indicator */
        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 14px;
            display: none;
        }
        
        .loading {
            display: block;
        }
        
        /* Box selection */
        .box-selector {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            backdrop-filter: blur(10px);
        }
        
        .box-checkbox {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .box-checkbox label {
            font-size: 11px;
            color: #ccc;
        }
        
        @media (max-width: 768px) {
            .players-container {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(4, 1fr);
            }
            
            .main-controls {
                flex-wrap: wrap;
                justify-content: center;
                bottom: 10px;
                padding: 8px;
            }
            
            .url-input-container {
                top: 10px;
                min-width: 90vw;
            }
        }
    </style>
</head>
<body>
    <!-- Box selector -->
    <div class="box-selector">
        <div class="box-checkbox">
            <input type="checkbox" id="box1" checked>
            <label for="box1">Box 1</label>
        </div>
        <div class="box-checkbox">
            <input type="checkbox" id="box2" checked>
            <label for="box2">Box 2</label>
        </div>
        <div class="box-checkbox">
            <input type="checkbox" id="box3" checked>
            <label for="box3">Box 3</label>
        </div>
        <div class="box-checkbox">
            <input type="checkbox" id="box4" checked>
            <label for="box4">Box 4</label>
        </div>
    </div>

    <!-- URL input -->
    <div class="url-input-container">
        <select id="player-select">
            <option value="0">Player 1</option>
            <option value="1">Player 2</option>
            <option value="2">Player 3</option>
            <option value="3">Player 4</option>
        </select>
        <input type="text" id="url-input" placeholder="Enter stream URL">
        <button onclick="loadURL()">Load</button>
    </div>

    <!-- Players container -->
    <div class="players-container layout-2x2" id="players-container">
        <!-- Player slots will be generated here -->
    </div>

    <!-- Main controls -->
    <div class="main-controls">
        <select id="layout-select" onchange="changeLayout(this.value)">
            <option value="layout-2x2">2x2</option>
            <option value="layout-1x4">1x4</option>
            <option value="layout-4x1">4x1</option>
            <option value="layout-1x2">1x2</option>
            <option value="layout-2x1">2x1</option>
            <option value="layout-1x3">1x3</option>
            <option value="layout-3x1">3x1</option>
            <option value="layout-1x1">1x1</option>
        </select>
        
        <button onclick="playAll()">▶ Play All</button>
        <button onclick="reloadAll()">↻ Reload All</button>
        <button onclick="clearAll()">✕ Clear All</button>
        <button onclick="toggleFullscreen()">⛶ Fullscreen</button>
    </div>

    <!-- Fullscreen exit button -->
    <button class="fullscreen-exit-btn" onclick="exitFullscreen()">Exit Fullscreen</button>

    <!-- Status message -->
    <div class="status-message" id="status-message"></div>

    <script>
        // Global state
        const state = {
            players: Array(4).fill().map((_, i) => ({
                id: i,
                iframe: null,
                currentUrl: null,
                history: [],
                historyIndex: -1,
                isFullscreen: false,
                playbackRate: 1.0,
                loading: false
            })),
            currentLayout: 'layout-2x2',
            fullscreenPlayer: null
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializePlayers();
            setupEventListeners();
            updateBoxVisibility();
            
            // Set initial URLs for testing (optional)
            // state.players[0].currentUrl = 'https://www.youtube.com/embed/dQw4w9WgXcQ';
            // state.players[1].currentUrl = 'https://www.youtube.com/embed/dQw4w9WgXcQ';
            // loadInitialURLs();
        });

        function initializePlayers() {
            const container = document.getElementById('players-container');
            container.innerHTML = '';
            
            state.players.forEach((player, index) => {
                const slot = document.createElement('div');
                slot.className = 'player-slot';
                slot.dataset.playerId = index;
                slot.innerHTML = `
                    <div class="player-controls-overlay">
                        <div class="player-title">
                            Player ${index + 1}
                            <span id="status-${index}" style="font-size:10px;color:#aaa;"></span>
                        </div>
                        <div class="player-buttons">
                            <button onclick="navigateBack(${index})" title="Back">◀</button>
                            <button onclick="reloadPlayer(${index})" title="Reload">↻</button>
                            <button onclick="navigateForward(${index})" title="Forward">▶</button>
                            <div class="speed-control">
                                <button onclick="toggleSpeedMenu(${index})" title="Speed">${player.playbackRate}x</button>
                                <div class="speed-dropdown" id="speed-menu-${index}">
                                    <div class="speed-option ${player.playbackRate === 0.5 ? 'active' : ''}" onclick="setSpeed(${index}, 0.5)">0.5x</div>
                                    <div class="speed-option ${player.playbackRate === 0.75 ? 'active' : ''}" onclick="setSpeed(${index}, 0.75)">0.75x</div>
                                    <div class="speed-option ${player.playbackRate === 1.0 ? 'active' : ''}" onclick="setSpeed(${index}, 1.0)">1.0x</div>
                                    <div class="speed-option ${player.playbackRate === 1.25 ? 'active' : ''}" onclick="setSpeed(${index}, 1.25)">1.25x</div>
                                    <div class="speed-option ${player.playbackRate === 1.5 ? 'active' : ''}" onclick="setSpeed(${index}, 1.5)">1.5x</div>
                                    <div class="speed-option ${player.playbackRate === 2.0 ? 'active' : ''}" onclick="setSpeed(${index}, 2.0)">2.0x</div>
                                </div>
                            </div>
                            <button onclick="togglePlayerFullscreen(${index})" title="Fullscreen">⛶</button>
                        </div>
                    </div>
                    <div class="video-container">
                        <div class="loading-indicator" id="loading-${index}">Loading...</div>
                        <iframe 
                            class="video-frame" 
                            id="iframe-${index}"
                            frameborder="0" 
                            allow="autoplay; encrypted-media; fullscreen"
                            allowfullscreen
                            referrerpolicy="no-referrer"
                            sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
                            src="about:blank"
                        ></iframe>
                    </div>
                `;
                container.appendChild(slot);
                
                player.iframe = document.getElementById(`iframe-${index}`);
                
                // Setup iframe event listeners
                setupIframeEvents(index);
            });
        }

        function setupIframeEvents(playerIndex) {
            const iframe = state.players[playerIndex].iframe;
            if (!iframe) return;
            
            iframe.onload = function() {
                state.players[playerIndex].loading = false;
                document.getElementById(`loading-${playerIndex}`).classList.remove('loading');
                updateStatus(`Player ${playerIndex + 1} loaded`, 'success');
                
                // Inject script to control fullscreen behavior
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const script = iframeDoc.createElement('script');
                    script.textContent = `
                        // Override fullscreen behavior
                        document.addEventListener('fullscreenchange', function(e) {
                            if (document.fullscreenElement) {
                                // Notify parent window
                                window.parent.postMessage({type: 'fullscreenRequest', playerId: ${playerIndex}}, '*');
                            }
                        });
                        
                        // Override requestFullscreen
                        Element.prototype._requestFullscreen = Element.prototype.requestFullscreen;
                        Element.prototype.requestFullscreen = function() {
                            window.parent.postMessage({type: 'fullscreenRequest', playerId: ${playerIndex}}, '*');
                            return Promise.resolve();
                        };
                    `;
                    iframeDoc.head.appendChild(script);
                } catch (e) {
                    // Cross-origin iframe, can't inject script
                }
            };
            
            iframe.onerror = function() {
                state.players[playerIndex].loading = false;
                document.getElementById(`loading-${playerIndex}`).classList.remove('loading');
                updateStatus(`Player ${playerIndex + 1} failed to load`, 'error');
            };
        }

        function setupEventListeners() {
            // Box selection checkboxes
            document.querySelectorAll('.box-checkbox input').forEach((checkbox, index) => {
                checkbox.addEventListener('change', updateBoxVisibility);
            });
            
            // Window message listener for iframe communication
            window.addEventListener('message', function(event) {
                if (event.data.type === 'fullscreenRequest') {
                    const playerId = event.data.playerId;
                    togglePlayerFullscreen(playerId);
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Escape exits fullscreen
                if (e.key === 'Escape' && state.fullscreenPlayer !== null) {
                    exitFullscreen();
                }
                
                // Ctrl+R reloads all
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    reloadAll();
                }
                
                // Ctrl+F toggles fullscreen
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    toggleFullscreen();
                }
            });
            
            // URL input enter key
            document.getElementById('url-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loadURL();
                }
            });
        }

        function updateBoxVisibility() {
            const boxes = document.querySelectorAll('.player-slot');
            boxes.forEach((box, index) => {
                const checkbox = document.getElementById(`box${index + 1}`);
                if (checkbox && !checkbox.checked) {
                    box.style.display = 'none';
                    // Exit fullscreen if this box is in fullscreen
                    if (state.players[index].isFullscreen) {
                        exitPlayerFullscreen(index);
                    }
                } else {
                    box.style.display = 'flex';
                }
            });
            
            // Reapply layout
            changeLayout(state.currentLayout);
        }

        function loadURL() {
            const url = document.getElementById('url-input').value.trim();
            const playerIndex = parseInt(document.getElementById('player-select').value);
            
            if (!url) {
                updateStatus('Please enter a URL', 'error');
                return;
            }
            
            const player = state.players[playerIndex];
            
            // Add to history
            if (player.currentUrl) {
                player.history.push(player.currentUrl);
                player.historyIndex = player.history.length - 1;
            }
            
            player.currentUrl = url;
            player.loading = true;
            
            // Show loading indicator
            document.getElementById(`loading-${playerIndex}`).classList.add('loading');
            
            // Load URL with additional parameters for better compatibility
            let finalUrl = url;
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                if (!url.includes('embed')) {
                    // Convert YouTube URL to embed format
                    const videoId = extractYouTubeId(url);
                    if (videoId) {
                        finalUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
                    }
                }
            } else if (url.includes('m3u8')) {
                // For HLS streams, we could use a video player
                // For now, we'll try to load in iframe
                finalUrl = `https://player.vimeo.com/video?url=${encodeURIComponent(url)}`;
            }
            
            // Add autoplay parameter if not present
            if (!finalUrl.includes('autoplay=')) {
                finalUrl += (finalUrl.includes('?') ? '&' : '?') + 'autoplay=1';
            }
            
            // Add mute parameter to avoid autoplay restrictions
            if (!finalUrl.includes('mute=')) {
                finalUrl += '&mute=1';
            }
            
            player.iframe.src = finalUrl;
            updateStatus(`Loading URL in Player ${playerIndex + 1}`, 'info');
        }

        function extractYouTubeId(url) {
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        function reloadPlayer(playerIndex) {
            const player = state.players[playerIndex];
            if (player.iframe && player.iframe.src && player.iframe.src !== 'about:blank') {
                player.loading = true;
                document.getElementById(`loading-${playerIndex}`).classList.add('loading');
                player.iframe.src = player.iframe.src + '&t=' + Date.now();
                updateStatus(`Reloading Player ${playerIndex + 1}`, 'info');
            }
        }

        function navigateBack(playerIndex) {
            const player = state.players[playerIndex];
            if (player.historyIndex > 0) {
                player.historyIndex--;
                const url = player.history[player.historyIndex];
                player.currentUrl = url;
                player.iframe.src = url;
                updateStatus(`Going back in Player ${playerIndex + 1}`, 'info');
            }
        }

        function navigateForward(playerIndex) {
            const player = state.players[playerIndex];
            if (player.historyIndex < player.history.length - 1) {
                player.historyIndex++;
                const url = player.history[player.historyIndex];
                player.currentUrl = url;
                player.iframe.src = url;
                updateStatus(`Going forward in Player ${playerIndex + 1}`, 'info');
            }
        }

        function toggleSpeedMenu(playerIndex) {
            const menu = document.getElementById(`speed-menu-${playerIndex}`);
            menu.classList.toggle('show');
            
            // Close other speed menus
            document.querySelectorAll('.speed-dropdown').forEach(m => {
                if (m.id !== `speed-menu-${playerIndex}`) {
                    m.classList.remove('show');
                }
            });
        }

        function setSpeed(playerIndex, speed) {
            const player = state.players[playerIndex];
            player.playbackRate = speed;
            
            // Update button text
            const button = document.querySelector(`#speed-menu-${playerIndex}`).previousElementSibling;
            button.textContent = `${speed}x`;
            
            // Update active class
            document.querySelectorAll(`#speed-menu-${playerIndex} .speed-option`).forEach(opt => {
                opt.classList.remove('active');
                if (parseFloat(opt.textContent) === speed) {
                    opt.classList.add('active');
                }
            });
            
            // Close menu
            document.getElementById(`speed-menu-${playerIndex}`).classList.remove('show');
            
            // Try to set playback rate on iframe
            try {
                const iframe = player.iframe;
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const videos = iframeDoc.querySelectorAll('video');
                videos.forEach(video => {
                    video.playbackRate = speed;
                });
            } catch (e) {
                // Cross-origin restriction
            }
            
            updateStatus(`Player ${playerIndex + 1} speed: ${speed}x`, 'success');
        }

        function togglePlayerFullscreen(playerIndex) {
            const player = state.players[playerIndex];
            const slot = document.querySelector(`.player-slot[data-player-id="${playerIndex}"]`);
            
            if (player.isFullscreen) {
                exitPlayerFullscreen(playerIndex);
            } else {
                // Exit any other fullscreen player
                if (state.fullscreenPlayer !== null) {
                    exitPlayerFullscreen(state.fullscreenPlayer);
                }
                
                enterPlayerFullscreen(playerIndex, slot);
            }
        }

        function enterPlayerFullscreen(playerIndex, slot) {
            const player = state.players[playerIndex];
            player.isFullscreen = true;
            state.fullscreenPlayer = playerIndex;
            slot.classList.add('fullscreen');
            
            // Hide other controls
            document.querySelectorAll('.main-controls, .url-input-container, .box-selector').forEach(el => {
                el.style.display = 'none';
            });
            
            updateStatus(`Player ${playerIndex + 1} fullscreen`, 'info');
        }

        function exitPlayerFullscreen(playerIndex) {
            const player = state.players[playerIndex];
            const slot = document.querySelector(`.player-slot[data-player-id="${playerIndex}"]`);
            
            player.isFullscreen = false;
            state.fullscreenPlayer = null;
            slot.classList.remove('fullscreen');
            
            // Show controls
            document.querySelectorAll('.main-controls, .url-input-container, .box-selector').forEach(el => {
                el.style.display = 'flex';
            });
            
            updateStatus(`Exited fullscreen`, 'info');
        }

        function exitFullscreen() {
            if (state.fullscreenPlayer !== null) {
                exitPlayerFullscreen(state.fullscreenPlayer);
            }
        }

        function toggleFullscreen() {
            if (state.fullscreenPlayer !== null) {
                exitFullscreen();
            } else {
                // Enter app fullscreen
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                }
            }
        }

        function changeLayout(layout) {
            const container = document.getElementById('players-container');
            container.className = 'players-container ' + layout;
            state.currentLayout = layout;
            updateStatus(`Layout changed to ${layout.replace('layout-', '')}`, 'success');
        }

        function playAll() {
            state.players.forEach((player, index) => {
                if (player.iframe && player.iframe.src && player.iframe.src !== 'about:blank') {
                    try {
                        const iframe = player.iframe;
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const videos = iframeDoc.querySelectorAll('video');
                        videos.forEach(video => {
                            video.play().catch(e => console.log('Autoplay prevented'));
                        });
                    } catch (e) {
                        // Cross-origin restriction
                    }
                }
            });
            updateStatus('Playing all streams', 'success');
        }

        function reloadAll() {
            state.players.forEach((player, index) => {
                if (player.iframe && player.iframe.src && player.iframe.src !== 'about:blank') {
                    reloadPlayer(index);
                }
            });
        }

        function clearAll() {
            state.players.forEach((player, index) => {
                player.iframe.src = 'about:blank';
                player.currentUrl = null;
                player.history = [];
                player.historyIndex = -1;
                document.getElementById(`loading-${index}`).classList.remove('loading');
            });
            updateStatus('All players cleared', 'success');
        }

        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = `status-message show ${type}`;
            
            setTimeout(() => {
                statusEl.classList.remove('show');
            }, 3000);
        }

        function loadInitialURLs() {
            state.players.forEach((player, index) => {
                if (player.currentUrl) {
                    player.loading = true;
                    document.getElementById(`loading-${index}`).classList.add('loading');
                    player.iframe.src = player.currentUrl + (player.currentUrl.includes('?') ? '&' : '?') + 'autoplay=1&mute=1';
                }
            });
        }

        // Make functions available globally
        window.loadURL = loadURL;
        window.reloadPlayer = reloadPlayer;
        window.navigateBack = navigateBack;
        window.navigateForward = navigateForward;
        window.toggleSpeedMenu = toggleSpeedMenu;
        window.setSpeed = setSpeed;
        window.togglePlayerFullscreen = togglePlayerFullscreen;
        window.exitFullscreen = exitFullscreen;
        window.toggleFullscreen = toggleFullscreen;
        window.changeLayout = changeLayout;
        window.playAll = playAll;
        window.reloadAll = reloadAll;
        window.clearAll = clearAll;
    </script>
</body>
</html>